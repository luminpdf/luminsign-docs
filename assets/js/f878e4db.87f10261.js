"use strict";(self.webpackChunkluminsign=self.webpackChunkluminsign||[]).push([[4390],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>k});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=u(n),g=r,k=c["".concat(s,".").concat(g)]||c[g]||d[g]||l;return n?a.createElement(k,i(i({ref:t},p),{},{components:n})):a.createElement(k,i({ref:t},p))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,i=new Array(l);i[0]=g;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[c]="string"==typeof e?e:r,i[1]=o;for(var u=2;u<l;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},67032:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>l,metadata:()=>o,toc:()=>u});var a=n(87462),r=(n(67294),n(3905));const l={title:"Events",sidebar_position:2,sidebar_label:"Events and Callbacks"},i=void 0,o={unversionedId:"api/events",id:"api/events",title:"Events",description:'Lumin Sign events (aka "webhooks") are payloads of event metadata automatically sent to your system when something happens in Lumin Sign.',source:"@site/docs/api/events.mdx",sourceDirName:"api",slug:"/api/events",permalink:"/docs/api/events",draft:!1,editUrl:"https://github.com/luminpdf/luminsign-docs/blob/main/docs/api/events.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Events",sidebar_position:2,sidebar_label:"Events and Callbacks"},sidebar:"tutorialSidebar",previous:{title:"Authentication",permalink:"/docs/api/authentication"},next:{title:"Walkthroughs",permalink:"/docs/category/walkthroughs"}},s={},u=[{value:"Account callbacks",id:"account-callbacks",level:2},{value:"Callback Request",id:"callback-request",level:2},{value:"Event Payload",id:"event-payload",level:3},{value:"Securing Callbacks",id:"securing-callbacks",level:2},{value:"Signature Verification",id:"signature-verification",level:3},{value:"Failures and Retries",id:"failures-and-retries",level:2},{value:"Event Names",id:"event-names",level:2},{value:"Testing Webhooks Locally with ngrok",id:"testing-webhooks-locally-with-ngrok",level:2},{value:"Step 1: Installing ngrok",id:"step-1-installing-ngrok",level:3},{value:"Step 2: Starting a Local Server",id:"step-2-starting-a-local-server",level:3},{value:"Step 3: Creating a Secure Tunnel with ngrok",id:"step-3-creating-a-secure-tunnel-with-ngrok",level:3},{value:"Step 4: Configuring the Webhook URL",id:"step-4-configuring-the-webhook-url",level:3},{value:"Step 5: Testing the Webhook",id:"step-5-testing-the-webhook",level:3}],p={toc:u},c="wrapper";function d(e){let{components:t,...l}=e;return(0,r.kt)(c,(0,a.Z)({},p,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,'Lumin Sign events (aka "webhooks") are payloads of event metadata automatically sent to your system when something happens in Lumin Sign.'),(0,r.kt)("h2",{id:"account-callbacks"},"Account callbacks"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Account Callbacks")," notify your system when an event happens involving your account by sending the event payload to your account callback url."),(0,r.kt)("p",null,"The ",(0,r.kt)("strong",{parentName:"p"},"Account Callbacks")," can be configured on the ",(0,r.kt)("a",{parentName:"p",href:"https://sign.luminpdf.com/developer/configuration"},"Developer Settings page"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:n(101).Z,width:"1750",height:"330"})),(0,r.kt)("h2",{id:"callback-request"},"Callback Request"),(0,r.kt)("h3",{id:"event-payload"},"Event Payload"),(0,r.kt)("p",null,"Event payloads always include an ",(0,r.kt)("em",{parentName:"p"},"event")," field, which contains basic information about the event that occurred."),(0,r.kt)("p",null,"Event payloads may include information about the event occurred:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "event" : {\n    "event_time": 1694664207595,\n    "event_type": "signature_request_sent", //  the name of the specific event that occurred\n    ...\n  },\n  "signature_request": {\n    "signature_request_id": "fa5c8a0b0f492d768749333ad6fcc214c111e967",\n    "title": "My first request",\n    "is_complete": false,\n    ...\n  }\n}\n')),(0,r.kt)("h2",{id:"securing-callbacks"},"Securing Callbacks"),(0,r.kt)("h3",{id:"signature-verification"},"Signature Verification"),(0,r.kt)("p",null,"We provide a couple of headers on callback requests:"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"User-Agent"),": Sender agent. Always ",(0,r.kt)("inlineCode",{parentName:"p"},"Lumin Sign API")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"X-Signature"),": A hex digest SHA256 signature of the request's JSON payload, generated using your ",(0,r.kt)("a",{parentName:"p",href:"/docs/api/authentication/#multiple-api-keys"},"Primary API key")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Example X-Signature"',title:'"Example','X-Signature"':!0},'api_key=\'my_primary_api_key\'\njson=\'{"event": { "event_time": 1694664207595, "event_type": "signature_request_sent" }, "signature_request": { "signature_request_id": "fa5c8a0b0f492d768749333ad6fcc214c111e967", "title": "My first request" } }\'\n\necho -n $json | openssl dgst -sha256 -hmac $api_key (X-Signature = 3810cb411041efab279d31698b9584372e5ede9d1641fbb354810f16e51be81c)\n')),(0,r.kt)("h2",{id:"failures-and-retries"},"Failures and Retries"),(0,r.kt)("p",null,"Our requests will timeout after 30 seconds, so callbacks will fail if your server takes longer than that to respond."),(0,r.kt)("p",null,"The retry pattern is described below:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Retry"),(0,r.kt)("th",{parentName:"tr",align:null},"Delay After Previous Attempt"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"First"),(0,r.kt)("td",{parentName:"tr",align:null},"5 minutes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Second"),(0,r.kt)("td",{parentName:"tr",align:null},"15 minutes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Third"),(0,r.kt)("td",{parentName:"tr",align:null},"45 minutes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Fourth"),(0,r.kt)("td",{parentName:"tr",align:null},"2 hours 15 minutes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Fifth"),(0,r.kt)("td",{parentName:"tr",align:null},"6 hours 45 minutes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Sixth"),(0,r.kt)("td",{parentName:"tr",align:null},"20 hours 15 minutes")))),(0,r.kt)("h2",{id:"event-names"},"Event Names"),(0,r.kt)("p",null,"Here is a list of webhook events that can be sent to your callback urls:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Event Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Attached API object"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"signature_request_created")),(0,r.kt)("td",{parentName:"tr",align:null},"The signature request is created successfully"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/api/get-signature-request/"},"Signature Request"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"signature_request_viewed")),(0,r.kt)("td",{parentName:"tr",align:null},"A signer opens the document"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/api/get-signature-request/"},"Signature Request"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"signature_request_approved")),(0,r.kt)("td",{parentName:"tr",align:null},"The document has been signed by all signers"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/api/get-signature-request/"},"Signature Request"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"signature_request_declined")),(0,r.kt)("td",{parentName:"tr",align:null},"A signer declines the document. This will turn the ",(0,r.kt)("inlineCode",{parentName:"td"},"status")," of the ",(0,r.kt)("inlineCode",{parentName:"td"},"signature_request")," to ",(0,r.kt)("inlineCode",{parentName:"td"},"REJECTED")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/api/get-signature-request/"},"Signature Request"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"signature_request_signed")),(0,r.kt)("td",{parentName:"tr",align:null},"The document has been signed by a signer"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/api/get-signature-request/"},"Signature Request"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"signature_request_invalid")),(0,r.kt)("td",{parentName:"tr",align:null},"An error occurred while processing the signature request data on our back-end i.e. invalid text tags"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/api/get-signature-request/"},"Signature Request Error"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"signature_request_canceled")),(0,r.kt)("td",{parentName:"tr",align:null},"The signature request is canceled"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/api/get-signature-request/"},"Signature Request Error"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"signature_request_cancel_failed")),(0,r.kt)("td",{parentName:"tr",align:null},"The signature request cancelation failed"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/api/get-signature-request/"},"Signature Request Error"))))),(0,r.kt)("h2",{id:"testing-webhooks-locally-with-ngrok"},"Testing Webhooks Locally with ngrok"),(0,r.kt)("p",null,"Webhooks require a publicly accessible URL to receive HTTP requests, which poses a problem during local development. Ngrok addresses this by creating a secure tunnel to your local server. This section will guide you through setting up ngrok and using it to test webhooks locally."),(0,r.kt)("h3",{id:"step-1-installing-ngrok"},"Step 1: Installing ngrok"),(0,r.kt)("p",null,"Install ngrok by following the instructions on the ",(0,r.kt)("a",{parentName:"p",href:"https://ngrok.com/docs/getting-started/"},"ngrok website"),"."),(0,r.kt)("h3",{id:"step-2-starting-a-local-server"},"Step 2: Starting a Local Server"),(0,r.kt)("p",null,"Before using ngrok, ensure your application is running locally on a specific port. For example, if you're developing a web application that listens on port ",(0,r.kt)("inlineCode",{parentName:"p"},"5090"),", ensure the application is accessible via ",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:<PORT>"),"."),(0,r.kt)("h3",{id:"step-3-creating-a-secure-tunnel-with-ngrok"},"Step 3: Creating a Secure Tunnel with ngrok"),(0,r.kt)("p",null,"To expose your local server to the Internet, use ngrok to create a secure tunnel to the port your application is running on:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"ngrok http 5090\n")),(0,r.kt)("p",null,"You will see something similar to the following console UI in your terminal.\n",(0,r.kt)("img",{alt:"image",src:n(54193).Z,width:"1898",height:"664"})),(0,r.kt)("p",null,"Replace ",(0,r.kt)("inlineCode",{parentName:"p"},"5090")," with the port number your local server is using. ngrok will start and display the session's information in your terminal, including the public URL(s) that ngrok has generated for your local server (e.g., ",(0,r.kt)("inlineCode",{parentName:"p"},"https://<random>.ngrok.io"),")."),(0,r.kt)("h3",{id:"step-4-configuring-the-webhook-url"},"Step 4: Configuring the Webhook URL"),(0,r.kt)("p",null,"At ",(0,r.kt)("a",{parentName:"p",href:"https://sign.luminpdf.com/developer/configuration"},"Developer Settings page"),", set the Account Callback URL to the ngrok URL generated in the previous step."),(0,r.kt)("p",null,"For example, if the ngrok URL is ",(0,r.kt)("inlineCode",{parentName:"p"},"https://425b-14-241-246-156.ngrok-free.app")," and your webhook handler path is ",(0,r.kt)("inlineCode",{parentName:"p"},"/webhook_handler"),", set the Account Callback URL to ",(0,r.kt)("inlineCode",{parentName:"p"},"https://425b-14-241-246-156.ngrok-free.app/webhook_handler"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:n(75009).Z,width:"1753",height:"673"})),(0,r.kt)("h3",{id:"step-5-testing-the-webhook"},"Step 5: Testing the Webhook"),(0,r.kt)("p",null,"You can now test the webhook by triggering an event that would cause the webhook to be sent."),(0,r.kt)("p",null,"For example, if you're testing the ",(0,r.kt)("inlineCode",{parentName:"p"},"signature_request_created")," event, create a new signature request in Lumin Sign and you will see something similar to the following console UI in your terminal."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:n(61350).Z,width:"1088",height:"808"})))}d.isMDXComponent=!0},101:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/account-callback-22ccae3c1dc858051ad4afea94d44173.png"},75009:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/callback_example-9ea25230c340febe32efa6ca79937138.png"},61350:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/callback_success_example-b91d420a63da1685f5e965eebd24b1d1.png"},54193:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ngrok_example-0e35066bceb40b8308a197242c65a640.png"}}]);